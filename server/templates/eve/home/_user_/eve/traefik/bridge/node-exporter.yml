http:
  middlewares:
    node-exporter-auth:
      basicAuth:
        users:
          - "{{ app_node_exporter_basic_auth_username }}:{{ app_node_exporter_basic_auth_password | password_hash('blowfish', rounds=10, ident='2y') }}"

  routers:
    node-exporter:
      entryPoints: ["websecure"]
      rule: "Host(`node-exporter.{{ ansible_hostname }}.{{ general_domain_default }}`)"
      service: node-exporter
      tls:
        certresolver: le-tls
      middlewares:
        - node-exporter-auth

  services:
    node-exporter:
      loadBalancer:
        servers:
          - url: "http://host.docker.internal:9100/"
