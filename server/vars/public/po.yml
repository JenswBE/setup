# Firewall
# Ensure to update firewall on cloud provider!
firewalld:
  - zone: public # Based on /usr/lib/firewalld/zones/public.xml
    source_networks: []
    allowed_services:
      - dhcpv6-client
      - http # 80/tcp
      - https # 443/tcp
      - http3 # 443/udp (QUIC)
      - ssh
    allowed_ports:
      - port: 8477 # Rsyncd over SSH
        proto: tcp
      - port: 51820 # Wireguard
        proto: udp
    extra_strings:
      - key: short
        value: Public
      - key: description
        value: For use in public areas. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.
    extra_booleans: [forward]
  - zone: wireguard
    source_networks: [wireguard_ipv4]
    allowed_services: []
    allowed_ports:
      - port: 6060 # CrowdSec Prometheus
        proto: tcp
      - port: 10050 # Zabbix agent
        proto: tcp
    extra_strings: []
    extra_booleans: []

# Redirects
redirects:
  - from: "www.{{ general_domain_bjoetiek }}"
    to: "{{ general_domain_bjoetiek }}"
  - from: "{{ general_domain_gwendv }}"
    to: "www.instagram.com/gwendolyndevocht/"
  - from: "www.{{ general_domain_gwendv }}"
    to: "www.instagram.com/gwendolyndevocht/"
  - from: "www.{{ general_domain_interwego }}"
    to: "{{ general_domain_interwego }}"
  - from: "{{ general_domain_interwego_be }}"
    to: "{{ general_domain_interwego }}"
  - from: "www.{{ general_domain_interwego_be }}"
    to: "{{ general_domain_interwego }}"
  - from: "{{ general_domain_interwego_eu }}"
    to: "{{ general_domain_interwego }}"
  - from: "www.{{ general_domain_interwego_eu }}"
    to: "{{ general_domain_interwego }}"
  - from: "{{ general_domain_interwego_nl }}"
    to: "{{ general_domain_interwego }}"
  - from: "www.{{ general_domain_interwego_nl }}"
    to: "{{ general_domain_interwego }}"
  - from: "{{ general_domain_local }}"
    to: "{{ general_domain_default }}"
  - from: "www.{{ general_domain_local }}"
    to: "{{ general_domain_default }}"
  - from: "www.{{ general_domain_wtech }}"
    to: "{{ general_domain_wtech }}"

# SWS config
sws_default_headers: &sws_default_headers
  Cross-Origin-Embedder-Policy: require-corp; report-to="default"
  Cross-Origin-Opener-Policy: same-origin; report-to="default"
  NEL: >-
    {
    "report_to":"default",
    "max_age":2592000,
    "include_subdomains":true,
    "failure_fraction":1.0
    }
  Permissions-Policy: >-
    accelerometer=(), ambient-light-sensor=(), autoplay=(),
    battery=(), camera=(), cross-origin-isolated=(), display-capture=(),
    encrypted-media=(), execution-while-not-rendered=(),
    execution-while-out-of-viewport=(), fullscreen=(), geolocation=(), gyroscope=(),
    keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(),
    payment=(), picture-in-picture=(), publickey-credentials-get=(),
    screen-wake-lock=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=();
    report-to=default
  Report-To: >-
    {
    "group":"default",
    "max_age":10886400,
    "endpoints":[{"url":"https://5e43cng1.uriports.com/reports"}],
    "include_subdomains":true
    }
  Reporting-Endpoints: 'default="https://5e43cng1.uriports.com/reports"'

sws_default_headers_without_report: &sws_default_headers_without_report
  Cross-Origin-Embedder-Policy: require-corp
  Cross-Origin-Opener-Policy: same-origin
  Permissions-Policy: >-
    accelerometer=(), ambient-light-sensor=(), autoplay=(),
    battery=(), camera=(), cross-origin-isolated=(), display-capture=(),
    encrypted-media=(), execution-while-not-rendered=(),
    execution-while-out-of-viewport=(), fullscreen=(), geolocation=(), gyroscope=(),
    keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(),
    payment=(), picture-in-picture=(), publickey-credentials-get=(),
    screen-wake-lock=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=()

sws_config:
  assets:
    advanced:
      headers:
        - source: "**"
          headers:
            <<: *sws_default_headers_without_report
            Content-Security-Policy: >-
              default-src 'none';
              font-src https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/;
              img-src 'self';
              script-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/ https://cdnjs.cloudflare.com/ajax/libs/mermaid/;
              style-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/ https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/;

  interwego:
    advanced:
      headers:
        - source: "**"
          headers:
            <<: *sws_default_headers
            Content-Security-Policy: >-
              default-src 'none';
              connect-src https://stats.{{ general_domain_interwego }}/count;
              img-src 'self' data:;
              script-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/ https://stats.{{ general_domain_interwego }}/count.js;
              style-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/;
              report-uri https://5e43cng1.uriports.com/reports/report;
              report-to default;

  wtech:
    advanced:
      headers:
        - source: "**"
          headers:
            <<: *sws_default_headers
            Content-Security-Policy: >-
              default-src 'none';
              connect-src https://stats.{{ general_domain_wtech }}/count;
              font-src https://fonts.gstatic.com/s/sourcesanspro/ https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/;
              img-src 'self' data:;
              script-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/ https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/ https://stats.{{ general_domain_wtech }}/count.js;
              style-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/ https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/ https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/;
              report-uri https://5e43cng1.uriports.com/reports/report;
              report-to default;

  email_username_generator:
    advanced:
      headers:
        - source: "**"
          headers:
            <<: *sws_default_headers_without_report
            Content-Security-Policy: >-
              default-src 'none';
              img-src 'self';
              script-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/;
              style-src 'self' https://cdnjs.cloudflare.com/ajax/libs/bootstrap/;
