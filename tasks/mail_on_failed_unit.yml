- name: Setup mail on failed systemd unit
  become: true
  block:
    - name: Add user systemd-mailjet
      ansible.builtin.user:
        name: systemd-mailjet
        system: true

    - name: Copy systemd-mailjet binary
      ansible.builtin.copy:
        src: systemd-mailjet
        dest: /opt/bin/systemd-mailjet
        owner: systemd-mailjet
        group: systemd-mailjet
        mode: 0500

    - name: Set systemd-mailjet config
      ansible.builtin.template:
        src: "systemd-mailjet.conf"
        dest: /opt/conf/systemd-mailjet.conf
        owner: systemd-mailjet
        group: systemd-mailjet
        mode: 0400
