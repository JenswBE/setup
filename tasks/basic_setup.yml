- name: Install base packages
  become: yes
  package:
      state: latest
      name: "{{ item }}"
  with_items:
    - htop
    - unattended-upgrades

- name: Configure unattended-upgrades
  become: yes
  copy:
    src: "../files/{{ item }}"
    dest: "/etc/apt/apt.conf.d/{{ item }}"
    owner: root
    group: root
    mode: 0644
  with_items:
    - 20auto-upgrades
    - 50unattended-upgrades

- name: Create opt directories
  become: yes
  file:
    path: "/opt/{{ item }}"
    state: directory
    owner: "root"
    group: "root"
    mode: 0700
  with_items:
    - bin
    - conf
    - appdata